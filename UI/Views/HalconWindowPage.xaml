<Page x:Class="UI.Views.HalconWindowPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:local="clr-namespace:UI.Views"
      xmlns:halconDotNet="clr-namespace:HalconDotNet;assembly=halcondotnet"
      xmlns:viewModels="clr-namespace:UI.ViewModels"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      mc:Ignorable="d"
      d:DesignHeight="600"
      d:DesignWidth="800"
      Title="HalconWindowPage"
      Loaded="HalconWindowPage_OnLoaded">
    <Grid>

        <Grid.Resources>
            <ResourceDictionary>
                <ResourceDictionary.MergedDictionaries>
                    <ResourceDictionary
                        Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.DataGrid.xaml" />
                </ResourceDictionary.MergedDictionaries>
            </ResourceDictionary>
        </Grid.Resources>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>


        <halconDotNet:HSmartWindowControlWPF Name="HalconWindow" Grid.Column="0" Panel.ZIndex="1">
            <halconDotNet:HIconicDisplayObjectWPF IconicObject="{Binding DisplayImage}" />
        </halconDotNet:HSmartWindowControlWPF>

        <materialDesign:Snackbar Grid.Column="0" MessageQueue="{Binding RunStatusMessageQueue}"></materialDesign:Snackbar>

        <!-- Find line param LIST -->
        <Expander Background="Transparent" HorizontalAlignment="Left" Margin="0 30 0 0" Grid.Column="0"
                  Grid.ColumnSpan="2" Panel.ZIndex="2" Foreground="AliceBlue" FontSize="24"
                  ExpandDirection="Left">
            <Expander.Header>
                <TextBlock
                    Text="Find line parameters" Foreground="AliceBlue"
                    RenderTransformOrigin=".5,.5">
                    <TextBlock.LayoutTransform>
                        <RotateTransform
                            Angle="90" />
                    </TextBlock.LayoutTransform>
                </TextBlock>
            </Expander.Header>
            <ScrollViewer HorizontalScrollBarVisibility="Auto">
                <DataGrid HorizontalAlignment="Right"
                          ItemsSource="{Binding FindLineParams}"
                          CanUserSortColumns="True"
                          CanUserAddRows="False" />
            </ScrollViewer>
        </Expander>


        <!-- ImageProvider Area -->
        <GroupBox Style="{DynamicResource MaterialDesignGroupBox}" Grid.Column="1" Header="Execution">
            <StackPanel>
                <Button
                    Height="50"
                    Margin="5 5"
                    Command="{Binding SelectImageDirCommand}"
                    Content="Select Image Directory" />
                <Button
                    Height="50"
                    Margin="5 5"
                    Command="{Binding OpenLastDirectoryCommand}"
                    Content="Open Last Directory" />
                <TextBox
                    materialDesign:HintAssist.Hint="Image Index To Show">
                    <TextBox.Text>
                        <Binding
                            Path="IndexToShow"
                            UpdateSourceTrigger="PropertyChanged" />
                    </TextBox.Text>
                </TextBox>
                <Grid Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <materialDesign:Badged BadgeColorZoneMode="PrimaryDark" Badge="{Binding NumImages}" Grid.Column="0">

                        <Button Style="{StaticResource MaterialDesignRaisedLightButton}"
                                Command="{Binding ExecuteCommand}">
                            Next
                        </Button>
                    </materialDesign:Badged>

                    <materialDesign:Chip Grid.Column="1" HorizontalAlignment="Right"
                                         Content="{Binding CurrentImageName}"
                                         Icon="Z" />
                </Grid>

                <Viewbox MaxHeight="40" Margin="10">
                    <ToggleButton
                        Style="{StaticResource MaterialDesignSwitchAccentToggleButton}"
                        IsChecked="{Binding MultipleImagesRunning}"
                        Command="{Binding ContinuousRunCommand}" CommandParameter="{Binding Path=IsChecked, RelativeSource={RelativeSource Self}}" />
                </Viewbox>
            </StackPanel>

        </GroupBox>

        <!--status area-->
        <GroupBox Grid.Column="1" VerticalAlignment="Bottom" Header="Status" FontSize="16">
            <StackPanel Orientation="Horizontal">
                <TextBlock>Time elapsed: </TextBlock>
                <TextBlock HorizontalAlignment="Center" Text="{Binding TimeElapsed}"></TextBlock>
            </StackPanel>
        </GroupBox>

        <!-- FAI LIST -->
        <Expander Grid.Column="0" Background="Transparent" HorizontalAlignment="Right" Panel.ZIndex="3" FontSize="24"
                  Grid.ColumnSpan="2" Margin="0 150 0 0"
                  ExpandDirection="Left">
            <Expander.Header>
                <TextBlock
                    Text="Outputs"
                    RenderTransformOrigin=".5,.5">
                    <TextBlock.LayoutTransform>
                        <RotateTransform
                            Angle="90" />
                    </TextBlock.LayoutTransform>
                </TextBlock>
            </Expander.Header>
            <DataGrid HorizontalAlignment="Right"
                      ItemsSource="{Binding FaiItems, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}"
                      CanUserSortColumns="True"
                      CanUserAddRows="False" />
        </Expander>


    </Grid>
</Page>